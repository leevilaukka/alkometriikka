import{p as F,s as Ve,a as Se}from"./hii8YTFM.js";import{m as pe,b as he,ab as oe,a3 as $,k as H,v as f,x as _,w as z,y as J,a9 as de,e as E,g as xe,o as ke,s as re,n as ce,j as e,ac as y,f as ve,aa as Pe,z as Ce,af as Oe,d as _e}from"./DDtI3ySZ.js";import{i as Z,b as ze}from"./MADWfPdD.js";import{r as se,s as j,c as Ee,d as Ie,e as Le,a as Te}from"./Bxanz9Be.js";import{y as we,z as Fe,I as Me,m as me,e as V,t as h,f as T,g as S,B as Ue,C as Ae,E as ye,s as ne,i as je}from"./D2H9T7Pv.js";import{b as ge,a as Be}from"./Dp9Vh1qo.js";import{S as Re}from"./BY6nYbWK.js";import{P as Ne}from"./DADVxvfE.js";import{d as qe,i as De}from"./T_EVkrq1.js";var He=(b,t,l,o)=>t([l(),o()]),Ke=H('<div class="flex flex-col"><label class="text-sm"> </label> <div class="flex w-full gap-2"><input type="number"/> <span class="my-auto">-</span> <input type="number"/> <button><!></button></div></div>');function Ge(b,t){he(t,!0);let l=F(t,"defaultValue",19,()=>[0,100]),o=F(t,"value",31,()=>oe([l()[0],l()[1]])),u=F(t,"modified",15,!1),r=F(t,"min",3,0),n=F(t,"max",3,100),ee=F(t,"step",3,1);$(()=>{const I=new Set(o()).difference(new Set(l()));u(!!I.size)});const M=we(t.label)!==""?`(${we(t.label)})`:"",v="numberinput-"+Fe();var x=Ke(),g=f(x),A=f(g,!0);_(g);var B=z(g,2),i=f(B);se(i);var P=z(i,4);se(P);var R=z(P,2);R.__click=[He,o,r,n];var N=f(R);Me(N,{name:"refresh_ccw"}),_(R),_(B),_(x),J((I,c,L,Q)=>{j(g,"for",v),de(A,I),j(i,"name",v),j(i,"min",r()),j(i,"max",o()[1]),j(i,"step",ee()),S(i,1,c),j(P,"min",o()[0]),j(P,"max",n()),j(P,"step",ee()),S(P,1,L),S(R,1,Q)},[()=>`${me(t.label)} ${M}`,()=>V(h(T.input(),"w-full")),()=>V(h(T.input(),"w-full")),()=>V(h(T.button()))]),ge(i,()=>o()[0],I=>o(o()[0]=I,!0)),ge(P,()=>o()[1],I=>o(o()[1]=I,!0)),E(b,x),xe()}pe(["click"]);var Je=(b,t,l)=>{b.target.checked?t([l()[0]]):t([])},Qe=H('<input class="ms-2 rounded p-2" type="checkbox"/>'),We=(b,t)=>t().showModal(),Xe=H("<button> </button>"),Ye=(b,t,l,o)=>{re(t,l().map(u=>({value:u,selected:!1})),!0),o(e(t).filter(u=>u.selected).map(u=>u.value))},Ze=(b,t,l,o)=>{re(t,l().map(u=>({value:u,selected:!0})),!0),o(e(t).filter(u=>u.selected).map(u=>u.value))},$e=(b,t,l,o)=>{t().selected=!t().selected,l(e(o).filter(u=>u.selected).map(u=>u.value))},et=H('<button><span class="max-w-full overflow-hidden overflow-ellipsis whitespace-nowrap"> </span> <input type="checkbox" class="ml-auto" readonly=""/></button>'),tt=(b,t)=>{t()?.close()},at=H('<div class="flex h-full max-h-full overflow-hidden flex-col gap-4"><div class="order-1 flex flex-row flex-wrap gap-4"><button>Tyhjennä valinnat</button> <button>Valitse kaikki</button></div> <input type="text" placeholder="Hae..."/> <div class="order-4 col-span-full flex h-[var(--height)] max-h-full flex-col overflow-auto rounded border border-primary lg:order-3 lg:col-span-1"><!></div></div> <div class="flex flex-row flex-wrap justify-end gap-4"><button>Sulje</button></div>',1),rt=H("<div><label> </label> <!></div>");function be(b,t){he(t,!0);const l=()=>Se(Ue,"$isSafari",o),[o,u]=Ve();let r=F(t,"defaultValue",19,()=>[]),n=F(t,"value",31,()=>oe(r())),ee=F(t,"modified",15,!1),M=F(t,"options",19,()=>[]);const v="stringinput-"+Fe();let x=ke(oe(M().map(c=>({value:c,selected:n().includes(c)}))));$(()=>{const c=new Set(n()).difference(new Set(r()));ee(!!c.size)}),$(()=>{n()&&n().length===0&&re(x,M().map(c=>({value:c,selected:!1})),!0)});const g=y(()=>n()?n().length>1?`${n().length} valittu`:n().length==1?n().at(0):"Ei valintoja":"Ei valintoja");let A=ke("");var B=rt(),i=f(B),P=f(i,!0);_(i);var R=z(i,2);{var N=c=>{var L=Qe();se(L),L.__change=[Je,n,M],J(Q=>{j(L,"name",v),Ee(L,Q)},[()=>n()&&n().includes(M()[0])]),E(c,L)},I=c=>{{const L=(a,U=ce)=>{var k=Xe();k.__click=[We,U];var K=f(k,!0);_(k),J((W,X)=>{j(k,"name",v),S(k,1,W),j(k,"title",X),de(K,e(g))},[()=>V(h(T.button(),"w-full justify-start")),()=>n()&&`${n().slice(0,3).join(", ")}${n().length>3?` + ${n().length-3} muuta`:""}`]),E(a,k)},Q=(a,U=ce)=>{var k=at(),K=ve(k),W=f(K),X=f(W);X.__click=[Ye,x,M,n];var te=z(X,2);te.__click=[Ze,x,M,n],_(W);var G=z(W,2);se(G);var ae=z(G,2);Ie(ae,"",{},{"--height":"560px;"});var fe=f(ae);{const Y=(d,m=ce,C=ce)=>{var q=et();q.__click=[$e,m,n,x];var w=f(q),D=f(w,!0);_(w);var O=z(w,2);se(O),_(q),J(le=>{S(q,1,le),j(w,"title",m().value),de(D,m().value)},[()=>V(h(T.button(),"w-full rounded-none border-none",C()%2===0&&"bg-gray-200 dark:bg-zinc-900",m().selected?"font-bold":""))]),Be(O,()=>m().selected,le=>m().selected=le),E(d,q)};let p=y(()=>e(A)?e(x).filter(d=>d.value.toLowerCase().includes(e(A).toLowerCase())):e(x));Re(fe,{get items(){return e(p)},bufferSize:30,renderItem:Y,$$slots:{renderItem:!0}})}_(ae),_(K);var ue=z(K,2),ie=f(ue);ie.__click=[tt,U],_(ue),J((Y,p,d,m)=>{S(X,1,Y),S(te,1,p),S(G,1,d),S(ie,1,m)},[()=>V(h(T.button({type:"negative"}))),()=>V(h(T.button())),()=>V(h(T.input(),"w-full")),()=>V(h(T.button({type:"negative"})))]),ge(G,()=>e(A),Y=>re(A,Y)),E(a,k)};let s=y(()=>h("p-4 gap-4",l()&&"h-auto"));Ne(c,{get class(){return e(s)},renderButton:L,renderContent:Q,$$slots:{renderButton:!0,renderContent:!0}})}};Z(R,c=>{M().length===1?c(N):c(I,!1)})}_(B),J(c=>{S(B,1,c),j(i,"for",v),de(P,t.label)},[()=>V(h("flex",M().length>1?"flex-col":"items-center"))]),E(b,B),xe(),u()}pe(["change","click"]);var lt=H('<div class="flex w-full flex-col text-sm gap-2"><!> <!></div>'),nt=(b,t,l)=>{t(De(l.kaljakori))},st=(b,t,l)=>{t(),re(l,!e(l))},ot=H("<button><span>Sulje suodattimet</span></button>"),ut=H('<dialog><!> <div class="sticky bottom-0 mt-auto flex w-full flex-col gap-2 backdrop:backdrop-blur-sm md:border-0 md:p-0"><button><!> <span>Tyhjennä suodattimet</span></button> <!></div></dialog>');function pt(b,t){he(t,!0);const l=()=>Se(je,"$isMobile",o),[o,u]=Ve();let r=F(t,"filterValues",15),n=F(t,"activeFilters",31,()=>oe([])),ee=F(t,"useURLParams",3,!0),M=Pe(Ae.SearchParamsManager),v,x=y(()=>!je),g=oe(ye.reduce((s,a)=>(s[a]=!1,s),{}));function A(){v&&(v.open?v.close():l()?v.showModal():v.show())}$(()=>{n(Object.entries(g).filter(([s,a])=>a).map(([s])=>s))}),$(()=>{v.open&&v.close(),!l()&&v.show()}),$(()=>{r()&&Object.keys(r()).forEach(s=>{Object.hasOwn(ne,s)&&r()[s].length!==1&&r()[ne[s]]?.length&&r(r()[ne[s]]=[],!0)})}),$(()=>{if(!ee())return;const s=qe(r(),t.kaljakori);M.setParametersFromObject(s).update()});var B={toggleFilterElement:A},i=ut(),P=f(i);Le(P,17,()=>ye,Te,(s,a)=>{const U=y(()=>t.kaljakori.getFilterValues(e(a))),k=y(()=>t.kaljakori.getFilterType(e(a)));var K=_e(),W=ve(K);{var X=te=>{var G=lt(),ae=f(G);{var fe=p=>{const d=y(()=>{const[m,C]=t.kaljakori.getMinAndMaxValues(e(a));return{min:m,max:C}});{let m=y(()=>[e(d).min,e(d).max]);Ge(p,{get defaultValue(){return e(m)},get label(){return e(a)},get min(){return e(d).min},get max(){return e(d).max},step:.01,get value(){return r()[e(a)]},set value(C){r(r()[e(a)]=C,!0)},get modified(){return g[e(a)]},set modified(C){g[e(a)]=C}})}},ue=p=>{var d=_e(),m=ve(d);{var C=w=>{{let D=y(()=>me(e(a)));be(w,{defaultValue:[],get label(){return e(D)},get options(){return e(U)},get name(){return e(a)},get value(){return r()[e(a)]},set value(O){r(r()[e(a)]=O,!0)},get modified(){return g[e(a)]},set modified(O){g[e(a)]=O}})}},q=w=>{{let D=y(()=>me(e(a)));be(w,{defaultValue:[],get label(){return e(D)},get options(){return e(U)},get name(){return e(a)},get value(){return r()[e(a)]},set value(O){r(r()[e(a)]=O,!0)},get modified(){return g[e(a)]},set modified(O){g[e(a)]=O}})}};Z(m,w=>{e(k)==="object"?w(C):w(q,!1)},!0)}E(p,d)};Z(ae,p=>{e(k)==="number"?p(fe):p(ue,!1)})}var ie=z(ae,2);{var Y=p=>{const d=y(()=>ne[e(a)]),m=y(()=>t.kaljakori.getSubFilterValues(e(a),r()[e(a)][0]));var C=_e(),q=ve(C);{var w=D=>{{let O=y(()=>me(e(d)));be(D,{defaultValue:[],get label(){return e(O)},get options(){return e(m)},get name(){return e(d)},get value(){return r()[e(d)]},set value(le){r(r()[e(d)]=le,!0)}})}};Z(q,D=>{e(m).length>1&&D(w)})}E(p,C)};Z(ie,p=>{Object.hasOwn(ne,e(a))&&r()[e(a)].length===1&&p(Y)})}_(G),E(te,G)};Z(W,te=>{(e(U).length>1||e(a)==="Uutuus"&&e(U).length===1)&&te(X)})}E(s,K)});var R=z(P,2),N=f(R);N.__click=[nt,r,t];var I=f(N);Me(I,{name:"x_circle"}),Ce(2),_(N);var c=z(N,2);{var L=s=>{var a=ot();a.__click=[st,A,x],J(U=>S(a,1,U),[()=>V(h(T.button(),"w-full"))]),E(s,a)};Z(c,s=>{l()&&s(L)})}_(R),_(i),ze(i,s=>v=s,()=>v),J((s,a)=>{S(i,1,s),S(N,1,a)},[()=>V(h("relative m-auto hidden h-full w-full flex-col gap-4 rounded-lg bg-primary border border-primary p-4 backdrop:backdrop-blur-sm open:flex md:relative md:rounded-none md:border-0 overflow-x-hidden overflow-y-auto transition-transform open:starting:scale-0 md:open:starting:scale-100 open:scale-100")),()=>V(h(T.button({type:"negative"}),"w-full","mt-auto"))]),Oe("close",i,()=>re(x,!1)),E(b,i);var Q=xe(B);return u(),Q}pe(["click"]);export{pt as F};
