import{p as V,s as Ve,a as Se}from"./B1IEMRCk.js";import{j as pe,a as he,a9 as oe,a1 as $,i as H,m as f,q as m,o as C,v as G,a7 as ce,d as O,e as xe,k as ke,s as re,n as de,g as e,aa as w,f as ve,a8 as Pe,w as Ce,ad as Oe,b as _e}from"./Blx9tMFz.js";import{i as Z,b as Ie}from"./D90skVT9.js";import{r as se,s as y,c as Ee,d as Le,e as Te,a as Ue}from"./2tuZ5JlQ.js";import{I as Fe,g as I,t as j,h as z,i as E,r as ze,C as Ae,v as we,d as ne,j as ye}from"./Dz1ThuZh.js";import{b as ge,a as Re}from"./_P1QabsG.js";import{b as je,c as Me,h as fe}from"./LXmW7SWr.js";import{S as qe}from"./By9aO5cc.js";import{P as Be}from"./Bk0acZ1W.js";import{d as Ne,i as De}from"./Bd-HB-3y.js";var He=(_,t,l,o)=>t([l(),o()]),Ke=H('<div class="flex flex-col"><label class="text-sm"> </label> <div class="flex w-full gap-2"><input type="number"/> <span class="my-auto">-</span> <input type="number"/> <button><!></button></div></div>');function Ge(_,t){he(t,!0);let l=V(t,"defaultValue",19,()=>[0,100]),o=V(t,"value",31,()=>oe([l()[0],l()[1]])),u=V(t,"modified",15,!1),r=V(t,"min",3,0),n=V(t,"max",3,100),ee=V(t,"step",3,1);$(()=>{const L=new Set(o()).difference(new Set(l()));u(!!L.size)});const S=je(t.label)!==""?`(${je(t.label)})`:"",v="numberinput-"+Me();var h=Ke(),g=f(h),A=f(g,!0);m(g);var R=C(g,2),i=f(R);se(i);var F=C(i,4);se(F);var q=C(F,2);q.__click=[He,o,r,n];var B=f(q);Fe(B,{name:"refresh_ccw"}),m(q),m(R),m(h),G((L,d,T,J)=>{y(g,"for",v),ce(A,L),y(i,"name",v),y(i,"min",r()),y(i,"max",o()[1]),y(i,"step",ee()),E(i,1,d),y(F,"min",o()[0]),y(F,"max",n()),y(F,"step",ee()),E(F,1,T),E(q,1,J)},[()=>`${fe(t.label)} ${S}`,()=>I(j(z.input(),"w-full")),()=>I(j(z.input(),"w-full")),()=>I(j(z.button()))]),ge(i,()=>o()[0],L=>o(o()[0]=L,!0)),ge(F,()=>o()[1],L=>o(o()[1]=L,!0)),O(_,h),xe()}pe(["click"]);var Je=(_,t,l)=>{_.target.checked?t([l()[0]]):t([])},Qe=H('<input class="ms-2 rounded p-2" type="checkbox"/>'),We=(_,t)=>t().showModal(),Xe=H("<button> </button>"),Ye=(_,t,l,o)=>{re(t,l().map(u=>({value:u,selected:!1})),!0),o(e(t).filter(u=>u.selected).map(u=>u.value))},Ze=(_,t,l,o)=>{re(t,l().map(u=>({value:u,selected:!0})),!0),o(e(t).filter(u=>u.selected).map(u=>u.value))},$e=(_,t,l,o)=>{t().selected=!t().selected,l(e(o).filter(u=>u.selected).map(u=>u.value))},et=H('<button><span class="max-w-full overflow-hidden overflow-ellipsis whitespace-nowrap"> </span> <input type="checkbox" class="ml-auto" readonly=""/></button>'),tt=(_,t)=>{t()?.close()},at=H('<div class="flex h-full max-h-full overflow-hidden flex-col gap-4"><div class="order-1 flex flex-row flex-wrap gap-4"><button>Tyhjennä valinnat</button> <button>Valitse kaikki</button></div> <input type="text" placeholder="Hae..." class="order-2 flex shrink-0 rounded border border-gray-300 px-1.5 py-0.5"/> <div class="order-4 col-span-full flex h-[var(--height)] max-h-full flex-col overflow-auto rounded border border-gray-300 lg:order-3 lg:col-span-1"><!></div></div> <div class="flex flex-row flex-wrap justify-end gap-4"><button>Sulje</button></div>',1),rt=H("<div><label> </label> <!></div>");function be(_,t){he(t,!0);const l=()=>Se(ze,"$isSafari",o),[o,u]=Ve();let r=V(t,"defaultValue",19,()=>[]),n=V(t,"value",31,()=>oe(r())),ee=V(t,"modified",15,!1),S=V(t,"options",19,()=>[]);const v="stringinput-"+Me();let h=ke(oe(S().map(d=>({value:d,selected:n().includes(d)}))));$(()=>{const d=new Set(n()).difference(new Set(r()));ee(!!d.size)}),$(()=>{n()&&n().length===0&&re(h,S().map(d=>({value:d,selected:!1})),!0)});const g=w(()=>n()?n().length>1?`${n().length} valittu`:n().length==1?n().at(0):"Ei valintoja":"Ei valintoja");let A=ke("");var R=rt(),i=f(R),F=f(i,!0);m(i);var q=C(i,2);{var B=d=>{var T=Qe();se(T),T.__change=[Je,n,S],G(J=>{y(T,"name",v),Ee(T,J)},[()=>n()&&n().includes(S()[0])]),O(d,T)},L=d=>{{const T=(a,U=de)=>{var x=Xe();x.__click=[We,U];var K=f(x,!0);m(x),G((Q,W)=>{y(x,"name",v),E(x,1,Q),y(x,"title",W),ce(K,e(g))},[()=>I(j(z.button(),"w-full justify-start")),()=>n()&&`${n().slice(0,3).join(", ")}${n().length>3?` + ${n().length-3} muuta`:""}`]),O(a,x)},J=(a,U=de)=>{var x=at(),K=ve(x),Q=f(K),W=f(Q);W.__click=[Ye,h,S,n];var te=C(W,2);te.__click=[Ze,h,S,n],m(Q);var X=C(Q,2);se(X);var ae=C(X,2);Le(ae,"",{},{"--height":"560px;"});var me=f(ae);{const Y=(c,b=de,M=de)=>{var N=et();N.__click=[$e,b,n,h];var k=f(N),D=f(k,!0);m(k);var P=C(k,2);se(P),m(N),G(le=>{E(N,1,le),y(k,"title",b().value),ce(D,b().value)},[()=>I(j(z.button(),"w-full rounded-none border-none",M()%2===0?"bg-gray-200":"bg-white",b().selected?"font-bold":""))]),Re(P,()=>b().selected,le=>b().selected=le),O(c,N)};let p=w(()=>e(A)?e(h).filter(c=>c.value.toLowerCase().includes(e(A).toLowerCase())):e(h));qe(me,{get items(){return e(p)},bufferSize:30,renderItem:Y,$$slots:{renderItem:!0}})}m(ae),m(K);var ue=C(K,2),ie=f(ue);ie.__click=[tt,U],m(ue),G((Y,p,c)=>{E(W,1,Y),E(te,1,p),E(ie,1,c)},[()=>I(j(z.button({type:"negative"}))),()=>I(j(z.button())),()=>I(j(z.button({type:"negative"})))]),ge(X,()=>e(A),Y=>re(A,Y)),O(a,x)};let s=w(()=>j("p-4 gap-4",l()&&"h-auto"));Be(d,{get class(){return e(s)},renderButton:T,renderContent:J,$$slots:{renderButton:!0,renderContent:!0}})}};Z(q,d=>{S().length===1?d(B):d(L,!1)})}m(R),G(d=>{E(R,1,d),y(i,"for",v),ce(F,t.label)},[()=>I(j("flex",S().length>1?"flex-col":"items-center"))]),O(_,R),xe(),u()}pe(["change","click"]);var lt=H('<div class="flex w-full flex-col text-sm gap-2"><!> <!></div>'),nt=(_,t,l)=>{t(De(l.kaljakori))},st=(_,t,l)=>{t(),re(l,!e(l))},ot=H("<button><span>Sulje suodattimet</span></button>"),ut=H('<dialog><!> <div class="sticky bottom-0 mt-auto flex w-full flex-col gap-2 backdrop:backdrop-blur-sm md:border-0 md:p-0"><button><!> <span>Tyhjennä suodattimet</span></button> <!></div></dialog>');function ht(_,t){he(t,!0);const l=()=>Se(ye,"$isMobile",o),[o,u]=Ve();let r=V(t,"filterValues",15),n=V(t,"activeFilters",31,()=>oe([])),ee=V(t,"useURLParams",3,!0),S=Pe(Ae.SearchParamsManager),v,h=w(()=>!ye),g=oe(we.reduce((s,a)=>(s[a]=!1,s),{}));function A(){v&&(v.open?v.close():l()?v.showModal():v.show())}$(()=>{n(Object.entries(g).filter(([s,a])=>a).map(([s])=>s))}),$(()=>{v.open&&v.close(),!l()&&v.show()}),$(()=>{r()&&Object.keys(r()).forEach(s=>{Object.hasOwn(ne,s)&&r()[s].length!==1&&r()[ne[s]].length&&r(r()[ne[s]]=[],!0)})}),$(()=>{if(!ee())return;const s=Ne(r(),t.kaljakori);S.setParametersFromObject(s).update()});var R={toggleFilterElement:A},i=ut(),F=f(i);Te(F,17,()=>we,Ue,(s,a)=>{const U=w(()=>t.kaljakori.getFilterValues(e(a))),x=w(()=>t.kaljakori.getFilterType(e(a)));var K=_e(),Q=ve(K);{var W=te=>{var X=lt(),ae=f(X);{var me=p=>{const c=w(()=>{const[b,M]=t.kaljakori.getMinAndMaxValues(e(a));return{min:b,max:M}});{let b=w(()=>[e(c).min,e(c).max]);Ge(p,{get defaultValue(){return e(b)},get label(){return e(a)},get min(){return e(c).min},get max(){return e(c).max},step:.01,get value(){return r()[e(a)]},set value(M){r(r()[e(a)]=M,!0)},get modified(){return g[e(a)]},set modified(M){g[e(a)]=M}})}},ue=p=>{var c=_e(),b=ve(c);{var M=k=>{{let D=w(()=>fe(e(a)));be(k,{defaultValue:[],get label(){return e(D)},get options(){return e(U)},get name(){return e(a)},get value(){return r()[e(a)]},set value(P){r(r()[e(a)]=P,!0)},get modified(){return g[e(a)]},set modified(P){g[e(a)]=P}})}},N=k=>{{let D=w(()=>fe(e(a)));be(k,{defaultValue:[],get label(){return e(D)},get options(){return e(U)},get name(){return e(a)},get value(){return r()[e(a)]},set value(P){r(r()[e(a)]=P,!0)},get modified(){return g[e(a)]},set modified(P){g[e(a)]=P}})}};Z(b,k=>{e(x)==="object"?k(M):k(N,!1)},!0)}O(p,c)};Z(ae,p=>{e(x)==="number"?p(me):p(ue,!1)})}var ie=C(ae,2);{var Y=p=>{const c=w(()=>ne[e(a)]),b=w(()=>t.kaljakori.getSubFilterValues(e(a),r()[e(a)][0]));var M=_e(),N=ve(M);{var k=D=>{{let P=w(()=>fe(e(c)));be(D,{defaultValue:[],get label(){return e(P)},get options(){return e(b)},get name(){return e(c)},get value(){return r()[e(c)]},set value(le){r(r()[e(c)]=le,!0)}})}};Z(N,D=>{e(b).length>1&&D(k)})}O(p,M)};Z(ie,p=>{Object.hasOwn(ne,e(a))&&r()[e(a)].length===1&&p(Y)})}m(X),O(te,X)};Z(Q,te=>{(e(U).length>1||e(a)==="Uutuus"&&e(U).length===1)&&te(W)})}O(s,K)});var q=C(F,2),B=f(q);B.__click=[nt,r,t];var L=f(B);Fe(L,{name:"x_circle"}),Ce(2),m(B);var d=C(B,2);{var T=s=>{var a=ot();a.__click=[st,A,h],G(U=>E(a,1,U),[()=>I(j(z.button(),"w-full"))]),O(s,a)};Z(d,s=>{l()&&s(T)})}m(q),m(i),Ie(i,s=>v=s,()=>v),G((s,a)=>{E(i,1,s),E(B,1,a)},[()=>I(j("relative m-auto hidden h-full w-full flex-col gap-4 rounded-lg border border-gray-200 p-4 backdrop:backdrop-blur-sm open:flex md:relative md:rounded-none md:border-0 overflow-x-hidden overflow-y-auto")),()=>I(j(z.button({type:"negative"}),"w-full","mt-auto"))]),Oe("close",i,()=>re(h,!1)),O(_,i);var J=xe(R);return u(),J}pe(["click"]);export{ht as F};
