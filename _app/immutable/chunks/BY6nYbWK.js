import{p as ot}from"./hii8YTFM.js";import{b as zt,ab as Rt,a3 as at,j as i,ac as X,o as C,s as f,t as $,V as qt,k as gt,v as T,x as _,e as lt,g as Vt,u as Wt,f as jt,w as A,X as Nt,aA as Gt,y as xt,a9 as V}from"./DDtI3ySZ.js";import{b as St,i as Ht}from"./MADWfPdD.js";import{f as vt,e as Kt,S as Bt,s as Xt,d as Lt}from"./Bxanz9Be.js";import{j as Yt,P as Jt,B as Qt}from"./T_EVkrq1.js";import{A as D,I as Zt,e as At,K as kt,H as ut,t as Pt,g as Ut,m as $t,U as te}from"./D2H9T7Pv.js";const ee={smoothScroll:!0,shouldThrowOnBounds:!0,align:"auto"},ie=(g,t,s)=>{if(g===0)return 0;const n=g*t;return Math.max(0,n-s)},Ot=(g,t,s,n,r,h,c,o,u,d,l)=>{if(h==="bottomToTop"){const b=Math.ceil(t/s)+1,w=d??n*s,H=Math.max(0,w-t)-g,I=Math.floor(H/s);if(I<0)return{start:0,end:Math.min(n,b+r*2)};const R=Math.max(0,I-r),M=Math.min(n,I+b+r);return{start:R,end:M}}else{const b=Math.floor(g/s),w=Math.min(n,b+Math.ceil(t/s)+1),x=d??n*s,H=Math.max(0,x-t),I=Math.max(1,Math.floor(s*.25));if(Math.abs(g-H)<=I){const P=n;let F=P,j=0;const tt=Y=>{const G=l?l[Y]:void 0;return Number.isFinite(G)&&G>0?G:s};for(;F>0&&j<t;){const Y=tt(F-1);j+=Y,F-=1}return{start:Math.max(0,F-r),end:P}}const M=Math.max(0,b-r),L=Math.min(n,w+r);return{start:M,end:L}}},se=(g,t,s,n,r,h,c,o,u)=>{const d=h||u||0;if(g==="bottomToTop"){const l=c??t*r,b=(t-s)*r,w=Math.max(0,d-l);return b+w}else{if(o){const l=W(o,r,n);return Math.max(0,Math.round(l))}return n*r}},re=(g,t,s=!1)=>{const{initialized:n,mode:r,containerElement:h,viewportElement:c,calculatedItemHeight:o,scrollTop:u}=g,{setHeight:d,setScrollTop:l}=t;if(s&&h&&c&&n){const b=h.getBoundingClientRect().height;if(d(b),r==="bottomToTop"){const x=Math.floor(u/o)*o;c.scrollTop=x,l(x)}}},ne=(g,t,s,n,r,h=0,c=0,o="topToBottom")=>{const u=g.filter(H=>H);if(u.length===0)return{newHeight:n,newLastMeasuredIndex:t.start,updatedHeightCache:s,clearedDirtyItems:new Set,newTotalHeight:h,newValidCount:c,heightChanges:[]};const d={...s},l=new Set,b=[];let w=h,x=c;return r.size>0?r.forEach(H=>{let I;o==="bottomToTop"?I=u.length-1-(H-t.start):I=H-t.start;const R=u[I];if(R&&I>=0&&I<u.length)try{R.offsetHeight;const M=R.getBoundingClientRect().height,L=d[H];if(Number.isFinite(M)&&M>0&&(!L||Math.abs(L-M)>=.1)){const P=L||n,F=M-P;b.push({index:H,oldHeight:P,newHeight:M,delta:F}),L&&Number.isFinite(L)&&L>0?w=w-L+M:(w+=M,x++),d[H]=M}l.add(H)}catch{l.add(H)}else l.add(H)}):u.forEach((H,I)=>{const R=o==="bottomToTop"?Math.max(0,(t.end??t.start+u.length)-1-I):t.start+I;if(!d[R])try{const M=H.getBoundingClientRect().height;Number.isFinite(M)&&M>0&&(w+=M,x++,d[R]=M)}catch{}}),{newHeight:x>0?w/x:n,newLastMeasuredIndex:t.start,updatedHeightCache:d,clearedDirtyItems:l,newTotalHeight:w,newValidCount:x,heightChanges:b}},W=(g,t,s,n,r=1e3)=>{const h=Math.max(0,Math.floor(s));if(h<=0)return 0;{let c=0;for(let o=0;o<h;o++){const u=g[o],d=Number.isFinite(u)&&u>0?u:t;c+=d}return c}},ae=(g,t,s,n,r,h,c,o,u,d,l=0,b=0,w="topToBottom")=>{const x=s();return x.start===h&&d.size===0?null:(t&&clearTimeout(t),setTimeout(()=>{const{newHeight:I,newLastMeasuredIndex:R,updatedHeightCache:M,clearedDirtyItems:L,newTotalHeight:P,newValidCount:F,heightChanges:j}=ne(n,x,r,c,d,l,b,w);(Math.abs(I-c)>1||d.size>0)&&o({newHeight:I,newLastMeasuredIndex:R,updatedHeightCache:M,clearedDirtyItems:L,newTotalHeight:P,newValidCount:F,heightChanges:j})},u))};function oe(){let g=!1,t=null;return s=>{t=s,g||(g=!0,requestAnimationFrame(()=>{g=!1,t&&(t(),t=null)}))}}const le=(g,t,s,n=1)=>{const r=s[g];return r===void 0?!0:Math.abs(t-r)>n};function ce(g,t,s,n){return g?g.start!==t.start||g.end!==t.end||s!==n:!0}function he(g,t,s,n,r,h,c){const o=r<=1,u=r>=c-h-1;return{visibleItemsCount:g.end-g.start,startIndex:g.start,endIndex:g.end,totalItems:t,processedItems:s,averageItemHeight:n,atTop:o,atBottom:u,totalHeight:c}}const de=g=>{const{mode:t,align:s,targetIndex:n,itemsLength:r,calculatedItemHeight:h,height:c,scrollTop:o,firstVisibleIndex:u,lastVisibleIndex:d,heightCache:l}=g;return t==="bottomToTop"?ue({align:s,targetIndex:n,itemsLength:r,calculatedItemHeight:h,height:c,scrollTop:o,firstVisibleIndex:u,lastVisibleIndex:d,heightCache:l}):ge({align:s,targetIndex:n,calculatedItemHeight:h,height:c,scrollTop:o,firstVisibleIndex:u,lastVisibleIndex:d,heightCache:l})},ue=g=>{const{align:t,targetIndex:s,itemsLength:n,calculatedItemHeight:r,height:h,scrollTop:c,firstVisibleIndex:o,lastVisibleIndex:u,heightCache:d}=g,l=W(d,r,n),b=W(d,r,s),w=r;if(t==="auto"){if(s<o)return Math.max(0,l-(b+w));if(s>u-1)return Math.max(0,l-b-h);{const x=l-(b+w),H=l-b,I=Math.abs(c-x),R=Math.abs(c+h-H);return I<R?x:Math.max(0,H-h)}}else{if(t==="top")return Math.max(0,l-(b+w));if(t==="bottom")return Math.max(0,l-b-h);if(t==="nearest"){const x=l-(b+w),H=l-b;if(H<=c||x>=c+h){const I=Math.abs(c-x),R=Math.abs(c+h-H);return I<R?x:Math.max(0,H-h)}else return null}}return null},ge=g=>{const{align:t,targetIndex:s,calculatedItemHeight:n,height:r,scrollTop:h,firstVisibleIndex:c,lastVisibleIndex:o,heightCache:u}=g;if(t==="auto"){if(s<c)return W(u,n,s);if(s>o-1){const d=W(u,n,s+1);return Math.max(0,d-r)}else{const d=W(u,n,s),l=W(u,n,s+1),b=Math.abs(h-d),w=Math.abs(h+r-l);return b<w?d:Math.max(0,l-r)}}else{if(t==="top")return W(u,n,s);if(t==="bottom"){const d=W(u,n,s+1);return Math.max(0,d-r)}else if(t==="nearest"){const d=W(u,n,s),l=W(u,n,s+1);if(l<=h||d>=h+r){const b=Math.abs(h-d),w=Math.abs(h+r-l);return b<w?d:Math.max(0,l-r)}else return null}}return null},Ft={now:()=>typeof performance<"u"&&performance.now?performance.now():Date.now()},me=(g,t,s={})=>{const{leading:n=!0,trailing:r=!1}=s;let h=0,c=null,o=null,u=!0;const d=l=>{h=Ft.now(),g(...l)};return((...l)=>{const b=Ft.now(),w=u?t:b-h;if(o=l,c&&(clearTimeout(c),c=null),w>=t)n&&(u=!1,d(l)),r&&!n&&(c=setTimeout(()=>{o&&d(o),c=null},t));else if(u&&n)u=!1,d(l);else if(r){const x=t-w;c=setTimeout(()=>{o&&d(o),c=null},x)}})};var fe=gt("<!> <div><!></div>",1),pe=gt("<div><div><div><div></div></div></div></div>");function Se(g,t){zt(t,!0);const s=oe(),n=!1,r=ot(t,"items",19,()=>[]),h=ot(t,"defaultEstimatedItemHeight",3,40),c=ot(t,"debug",3,!1),o=ot(t,"mode",3,"topToBottom"),u=ot(t,"bufferSize",3,20),d=Rt([]);let l=C(0);const b=!1;let w=C(!1),x=C(-1),H=C(0),I=null,R=null,M=null;const L=Rt(new Set);let P=C(0),F=C(0),j=C(null),tt=C(0),Y=C(0),G=C(null);const e=new _e({itemLength:r().length,itemHeight:h(),internalDebug:n});let ct=C(0);const Mt=X(()=>()=>{const a=i(N)();return(o()==="bottomToTop"?r().slice(a.start,a.end).reverse():r().slice(a.start,a.end)).map((p,v)=>({item:p,originalIndex:o()==="bottomToTop"?a.end-1-v:a.start+v,sliceIndex:v}))}),mt=a=>{if(!e.viewportElement||!e.initialized||i(et))return;if(o()==="bottomToTop"&&Q&&!i(it)&&performance.now()>=i(ct)&&!e.isDynamicUpdateInProgress){const y=Math.max(0,i(z)()-i(l));e.viewport.scrollTop=y,e.scrollTop=y,$().then(()=>{const B=e.viewport.querySelector('[data-original-index="0"]');B&&(B.scrollIntoView({block:"end",behavior:"smooth",inline:"nearest"}),e.scrollTop=e.viewport.scrollTop)});return}const m=e.viewport.scrollTop,p=Math.max(0,i(z)()-i(l));let v=0;const S=i(N)();for(const y of a)y.index<S.start&&(v+=y.delta);if(Math.abs(v)>1){const y=Math.min(p,Math.max(0,m+v));e.viewport.scrollTop=y,e.scrollTop=y}},_t=me(()=>{i(P)>0&&(Q=i(st),e.startDynamicUpdate(),ht())},16,{leading:!0,trailing:!0});at(()=>{_t()}),at(()=>{e.updateItemLength(r().length)});const ht=()=>{f(Y,e.totalHeight,!0),I=ae(b,I,i(N),d,e.getHeightCache(),i(x),e.averageHeight,a=>{if(e.itemHeight=a.newHeight,f(x,a.newLastMeasuredIndex,!0),a.heightChanges.length>0&&e.processDirtyHeights(a.heightChanges),a.heightChanges.length>0&&o()==="bottomToTop"&&mt(a.heightChanges),o()==="topToBottom"&&e.isReady&&e.initialized){const m=i(Y),p=e.totalHeight,v=p-m;if(Math.abs(v)>1){const S=Math.max(0,p-(i(l)||0)),y=Math.max(e.averageHeight,10),B=e.viewport.scrollTop;if(Math.abs(B-S)<=y){const E=Math.min(S,Math.max(0,B+v));e.viewport.scrollTop=E,e.scrollTop=E}}}Wt(()=>{L.clear(),f(P,0),Q=!1}),e.endDynamicUpdate()},i(x)<0?0:100,L,0,0,o())};let et=C(!1),it=C(!1),dt=C(0),J=C(0);const z=X(()=>()=>e.totalHeight),st=X(()=>e.scrollTop>=i(z)()-i(l)-1);let Q=!1,K=null;function yt(){if(!e.viewportElement)return;const a=e.viewport.querySelector('[data-original-index="999"]');if(!a)return;const m=e.viewport.getBoundingClientRect(),p=a.getBoundingClientRect();f(G,Math.round(Math.abs(p.bottom-m.bottom)),!0)}at(()=>{if(e.initialized&&o()==="bottomToTop"&&e.viewportElement){const a=Math.max(0,i(z)()-i(l)),m=e.viewport.scrollTop,p=Math.abs(m-a),v=Math.abs(e.averageHeight-i(dt))>1,S=Math.max(0,i(z)()-i(l)),y=Math.abs(m-S)<e.averageHeight;if(v&&!i(et)&&!y&&!i(it)&&performance.now()>=i(ct)&&!e.isDynamicUpdateInProgress&&p>e.averageHeight*3){const q=Math.round(a);e.viewport.scrollTop=q,e.scrollTop=q}p>e.averageHeight*5&&f(et,!0),f(dt,e.averageHeight,!0)}}),at(()=>{const a=r().length;if(e.initialized&&o()==="bottomToTop"&&e.isReady&&i(J)>0&&a-i(J)!==0){const p=e.viewport.scrollTop,v=e.averageHeight,S=i(l),y=i(z)(),B=Math.max(0,y-S);(Math.abs(p-Math.max(0,i(J)*v-S))<v*2||p===0)&&e.runDynamicUpdate(()=>{const E=B;e.viewport.scrollTop=E,e.scrollTop=E,f(et,!1)})}f(J,a,!0)}),at(()=>{if(e.isReady){const a=e.container.getBoundingClientRect().height;Number.isFinite(a)&&a>0&&f(l,a,!0)}}),at(()=>{if(i(l)===0&&e.isReady){const a=e.container.getBoundingClientRect().height;Number.isFinite(a)&&a>0&&f(F,a,!0)}});const N=X(()=>()=>{if(!r().length)return{start:0,end:0};const a=i(l)||0;if(o()==="bottomToTop"&&!e.initialized&&e.scrollTop===0&&a>0){const m=Math.max(0,i(z)()-a);return K=Ot(m,a,e.averageHeight,r().length,u(),o(),i(st),Q,K,i(z)(),e.getHeightCache()),K}return K=Ot(e.scrollTop,a,e.averageHeight,r().length,u(),o(),i(st),Q,K,i(z)(),e.getHeightCache()),K}),Ct=()=>{e.viewportElement&&(i(w)||(f(w,!0),s(()=>{const a=e.viewport.scrollTop;o()==="bottomToTop"&&i(H)-a>.5&&(f(ct,performance.now()+300),f(et,!0)),f(H,a,!0),e.scrollTop=a,yt(),f(w,!1)})))},bt=(a=!1)=>{if(!e.initialized&&o()==="bottomToTop"){$().then(()=>{if(e.isReady){const m=e.container.getBoundingClientRect().height;f(l,m,!0),$().then(()=>{if(e.isReady){const p=e.container.getBoundingClientRect().height;f(l,p,!0);const v=ie(r().length,e.averageHeight,p);e.container.offsetHeight,e.viewport.scrollTop=v,e.scrollTop=v,requestAnimationFrame(()=>{e.viewport.scrollTop!==e.scrollTop&&(e.viewport.scrollTop=v,e.scrollTop=v),e.initialized=!0})}})}});return}re({initialized:e.initialized,mode:o(),containerElement:e.containerElement,viewportElement:e.viewportElement,calculatedItemHeight:e.averageHeight,height:i(l),scrollTop:e.scrollTop},{setHeight:m=>f(l,m,!0),setScrollTop:m=>e.scrollTop=m},a)};M=new ResizeObserver(a=>{$().then(()=>{let m=!1;i(N)();for(const p of a){const v=p.target,S=d.indexOf(v),y=parseInt(v.dataset.originalIndex||"-1",10);if(S!==-1&&y>=0){const B=v.getBoundingClientRect().height;le(y,B,e.getHeightCache())&&(i(P)===0&&(Q=i(st)),L.add(y),f(P,L.size,!0),m=!0)}}m&&s(()=>{ht()})})}),qt(()=>(bt(),$().then(()=>requestAnimationFrame(()=>requestAnimationFrame(()=>ht()))),R=new ResizeObserver(()=>{bt(!0)}),e.isReady&&R.observe(e.container),()=>{R&&R.disconnect(),M&&M.disconnect()})),at(()=>{});const It=(a,m=!0,p=!0)=>{ft({index:a,smoothScroll:m,shouldThrowOnBounds:p})},ft=async a=>{const{index:m,smoothScroll:p,shouldThrowOnBounds:v,align:S}={...ee,...a};if(!r().length)return;if(!e.viewportElement){$().then(()=>{e.viewportElement&&ft({index:m,smoothScroll:p,shouldThrowOnBounds:v,align:S})});return}let y=m;if(y<0||y>=r().length){if(v)throw new Error(`scroll: index ${y} is out of bounds (0-${r().length-1})`);y=Math.max(0,Math.min(y,r().length-1))}const{start:B,end:q}=i(N)(),E=de({mode:o(),align:S||"auto",targetIndex:y,itemsLength:r().length,calculatedItemHeight:e.averageHeight,height:i(l),scrollTop:e.scrollTop,firstVisibleIndex:B,lastVisibleIndex:q,heightCache:e.getHeightCache()});if(E!==null){if(f(it,!0),o()==="bottomToTop"&&p){const nt=e.viewport.querySelectorAll("[data-original-index]");let pt=-1,Tt=null;for(const wt of nt){const Et=parseInt(wt.getAttribute("data-original-index")||"-1");Et>pt&&(pt=Et,Tt=wt)}Tt?.scrollIntoView({behavior:"smooth"}),await $(),await new Promise(wt=>setTimeout(wt,100)),await $()}e.viewport.scrollTo({top:E,behavior:p?"smooth":"auto"}),requestAnimationFrame(()=>{e.scrollTop=E}),setTimeout(()=>{f(it,!1)},p?500:100)}};function Dt(a){return M&&M.observe(a),{destroy(){M&&M.unobserve(a)}}}var O={scrollToIndex:It,scroll:ft},k=pe();vt(k,()=>({id:"virtual-list-container",...t.testId?{"data-testid":`${t.testId}-container`}:{},class:t.containerClass??"virtual-list-container"}),void 0,void 0,"svelte-plopdb");var U=T(k);vt(U,()=>({id:"virtual-list-viewport",...t.testId?{"data-testid":`${t.testId}-viewport`}:{},class:t.viewportClass??"virtual-list-viewport",onscroll:Ct}),void 0,void 0,"svelte-plopdb");var Z=T(U);vt(Z,a=>({id:"virtual-list-content",...t.testId?{"data-testid":`${t.testId}-content`}:{},class:t.contentClass??"virtual-list-content",[Bt]:a}),[()=>({height:`${Math.max(i(l),i(z)())??""}px`})],void 0,"svelte-plopdb");var rt=T(Z);return vt(rt,a=>({id:"virtual-list-items",...t.testId?{"data-testid":`${t.testId}-items`}:{},class:t.itemsClass??"virtual-list-items",[Bt]:a}),[()=>({visibility:i(l)===0&&o()==="bottomToTop"?"hidden":"visible",transform:`translateY(${(()=>{const a=i(l)||i(F)||0,m=i(N)(),p=a===0?400:a;return Math.round(se(o(),r().length,m.end,m.start,e.averageHeight,p,i(z)(),e.getHeightCache(),i(F)))})()??""}px)`})],void 0,"svelte-plopdb"),Kt(rt,23,()=>i(Mt)(),a=>a.originalIndex,(a,m,p)=>{var v=fe(),S=jt(v);{var y=E=>{const nt=X(()=>he(i(N)(),r().length,Object.keys(e.getHeightCache()).length,e.averageHeight,e.scrollTop,i(l)||0,i(z)()));var pt=Gt();xt(Tt=>V(pt,Tt),[()=>t.debugFunction?t.debugFunction(i(nt)):void 0]),lt(E,pt)};Ht(S,E=>{c()&&i(p)===0&&ce(i(j),i(N)(),i(tt),e.averageHeight)&&E(y)})}var B=A(S,2);vt(B,()=>({"data-original-index":i(m).originalIndex,...t.testId?{"data-testid":`${t.testId}-item-${i(m).originalIndex}`}:{}}),void 0,void 0,"svelte-plopdb");var q=T(B);Nt(q,()=>t.renderItem,()=>i(m).item,()=>i(m).originalIndex),_(B),St(B,(E,nt)=>d[nt.sliceIndex]=E,E=>d?.[E.sliceIndex],()=>[i(m)]),Yt(B,E=>Dt?.(E)),lt(a,v)}),_(rt),_(Z),_(U),St(U,a=>e.viewportElement=a,()=>e?.viewportElement),_(k),St(k,a=>e.containerElement=a,()=>e?.containerElement),lt(g,k),Vt(O)}class ve{onRecompute;isScheduled=!1;isPending=!1;blockDepth=0;timeoutId=null;constructor(t){this.onRecompute=t}schedule=()=>{if(this.blockDepth>0){this.isPending=!0;return}this.isScheduled||(this.isScheduled=!0,this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null),this.timeoutId=setTimeout(()=>{this.timeoutId=null,this.isScheduled=!1,this.onRecompute()},0))};block=()=>{this.blockDepth+=1,this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null,this.isScheduled=!1,this.isPending=!0)};unblock=()=>{this.blockDepth!==0&&(this.blockDepth-=1,this.blockDepth===0&&this.isPending&&(this.isPending=!1,this.onRecompute()))};cancel=()=>{this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null),this.isScheduled=!1,this.isPending=!1}}class _e{#r=C(0);get _totalMeasuredHeight(){return i(this.#r)}set _totalMeasuredHeight(t){f(this.#r,t,!0)}#n=C(0);get _measuredCount(){return i(this.#n)}set _measuredCount(t){f(this.#n,t,!0)}#a=C(0);get _itemLength(){return i(this.#a)}set _itemLength(t){f(this.#a,t,!0)}#o=C(40);get _itemHeight(){return i(this.#o)}set _itemHeight(t){f(this.#o,t,!0)}#l=C(40);get _averageHeight(){return i(this.#l)}set _averageHeight(t){f(this.#l,t,!0)}#c=C(0);get _totalHeight(){return i(this.#c)}set _totalHeight(t){f(this.#c,t,!0)}_measuredFlags=null;#h=C(!1);get _initialized(){return i(this.#h)}set _initialized(t){f(this.#h,t,!0)}#d=C(0);get _scrollTop(){return i(this.#d)}set _scrollTop(t){f(this.#d,t,!0)}#u=C(null);get _containerElement(){return i(this.#u)}set _containerElement(t){f(this.#u,t,!0)}#g=C(null);get _viewportElement(){return i(this.#g)}set _viewportElement(t){f(this.#g,t,!0)}_internalDebug=!1;#m=C(!1);get _isReady(){return i(this.#m)}set _isReady(t){f(this.#m,t,!0)}#f=C(!1);get _dynamicUpdateInProgress(){return i(this.#f)}set _dynamicUpdateInProgress(t){f(this.#f,t,!0)}#p=C(0);get _dynamicUpdateDepth(){return i(this.#p)}set _dynamicUpdateDepth(t){f(this.#p,t,!0)}#v=C(null);get _itemsWrapperElement(){return i(this.#v)}set _itemsWrapperElement(t){f(this.#v,t,!0)}#_=C(!1);get _gridDetected(){return i(this.#_)}set _gridDetected(t){f(this.#_,t,!0)}#b=C(1);get _gridColumns(){return i(this.#b)}set _gridColumns(t){f(this.#b,t,!0)}_gridObserver=null;_mutationObserver=null;_heightCache={};_scheduler=new ve(()=>this.recomputeDerivedHeights());recomputeDerivedHeights(){const t=this._measuredCount>0?this._totalMeasuredHeight/this._measuredCount:this._itemHeight;this._averageHeight=t;const s=this._itemLength-this._measuredCount;this._totalHeight=this._totalMeasuredHeight+s*t}recomputeIsReady(){this._isReady=!!this._containerElement&&!!this._viewportElement}scheduleRecomputeDerivedHeights(){const t=typeof navigator<"u"&&typeof navigator.userAgent=="string"?/jsdom/i.test(navigator.userAgent):!1;if(typeof window>"u"||t){this.recomputeDerivedHeights();return}if(this._dynamicUpdateDepth>0){this._scheduler.block();return}this._scheduler.schedule()}get totalMeasuredHeight(){return this._totalMeasuredHeight}get measuredCount(){return this._measuredCount}get itemLength(){return this._itemLength}get itemHeight(){return this._itemHeight}set itemHeight(t){this._itemHeight=t,this.scheduleRecomputeDerivedHeights()}get initialized(){return this._initialized}set initialized(t){if(this._initialized)throw new Error("ReactiveListManager: initialized flag cannot be set to true after it has been set to true");this._initialized=t}get scrollTop(){return this._scrollTop}set scrollTop(t){this._internalDebug&&this.#w(t),this._scrollTop=t}get containerElement(){return this._containerElement}get container(){if(!this._isReady)throw new Error("ReactiveListManager: container is not ready");return this._containerElement}set containerElement(t){this._containerElement=t,this.recomputeIsReady()}get viewportElement(){return this._viewportElement}get viewport(){if(!this._isReady)throw new Error("ReactiveListManager: viewport is not ready");return this._viewportElement}set viewportElement(t){this._viewportElement=t,this.recomputeIsReady()}get itemsWrapperElement(){return this._itemsWrapperElement}set itemsWrapperElement(t){if(this._itemsWrapperElement!==t){if(this._gridObserver){try{this._gridObserver.disconnect()}catch{}this._gridObserver=null}if(this._mutationObserver){try{this._mutationObserver.disconnect()}catch{}this._mutationObserver=null}}if(this._itemsWrapperElement=t,!t){this._gridDetected=!1,this._gridColumns=1;return}this.#x(),this.#H(),this.#i()}get gridDetected(){return this._gridDetected}get gridColumns(){return this._gridColumns}get isReady(){return this._isReady}get isDynamicUpdateInProgress(){return this._dynamicUpdateDepth>0}startDynamicUpdate(){const t=this._dynamicUpdateDepth===0;this._dynamicUpdateDepth+=1,t&&(this._dynamicUpdateInProgress=!0,this._isReady&&this._viewportElement&&this._viewportElement.style.setProperty("overflow-anchor","none"))}endDynamicUpdate(){this._dynamicUpdateDepth<=0||(this._dynamicUpdateDepth-=1,this._dynamicUpdateDepth===0&&(this._isReady&&this._viewportElement&&this._viewportElement.style.setProperty("overflow-anchor","auto"),this._dynamicUpdateInProgress=!1,this._scheduler.unblock()))}async runDynamicUpdate(t){this.startDynamicUpdate();try{const s=t();return s instanceof Promise?await s:s}finally{this.endDynamicUpdate()}}#T=null;#s=0;#t=0;#e=!1;#w(t){const s=typeof performance<"u"&&performance.now?performance.now():Date.now();this.#T===t?s-this.#s<=1e3?(this.#t+=1,this.#t>10&&!this.#e&&(this.#e=!0)):(this.#s=s,this.#t=1,this.#e=!1):(this.#T=t,this.#s=s,this.#t=1,this.#e=!1)}get averageHeight(){return this._averageHeight}get totalHeight(){return this._totalHeight}flushRecompute=()=>{this.recomputeDerivedHeights()};getHeightCache(){return this._heightCache}constructor(t){this._itemLength=t.itemLength,this._itemHeight=t.itemHeight,this._internalDebug=t.internalDebug??!1,this._measuredFlags=new Uint8Array(Math.max(0,this._itemLength)),this.recomputeDerivedHeights()}processDirtyHeights(t){if(t.length===0)return;let s=0,n=0;for(const c of t){const{index:o,oldHeight:u,newHeight:d}=c;u!==void 0&&(s-=u,n-=1),d!==void 0?(s+=d,n+=1,this._heightCache[o]=d):delete this._heightCache[o],this._measuredFlags&&o>=0&&o<this._measuredFlags.length&&(this._measuredFlags[o]=1)}const r=typeof navigator<"u"&&typeof navigator.userAgent=="string"?/jsdom/i.test(navigator.userAgent):!1;if(typeof window>"u"||r){if(s===0&&n===0)return}else if(n===0)return;this._totalMeasuredHeight+=s,this._measuredCount+=n,this.scheduleRecomputeDerivedHeights()}updateItemLength(t){this._itemLength=t,this._measuredFlags=new Uint8Array(Math.max(0,t)),this.recomputeDerivedHeights()}updateEstimatedHeight(t){this._itemHeight=t,this.scheduleRecomputeDerivedHeights()}setMeasuredHeight(t,s){if(t<0||t>=this._itemLength)return;const n=this._heightCache[t];Number.isFinite(n)&&n>0?this._totalMeasuredHeight-=n:this._measuredCount+=1,Number.isFinite(s)&&s>0&&(this._heightCache[t]=s,this._totalMeasuredHeight+=s,this.scheduleRecomputeDerivedHeights())}reset(){this._totalMeasuredHeight=0,this._measuredCount=0,this._measuredFlags=this._itemLength>0?new Uint8Array(this._itemLength):null,this.scheduleRecomputeDerivedHeights()}getDebugInfo(){return{totalMeasuredHeight:this._totalMeasuredHeight,measuredCount:this._measuredCount,itemLength:this._itemLength,coveragePercent:this._itemLength>0?this._measuredCount/this._itemLength*100:0,itemHeight:this._itemHeight,averageHeight:this.averageHeight,totalHeight:this.totalHeight,gridDetected:this._gridDetected,gridColumns:this._gridColumns}}getMeasurementCoverage(){return this.getDebugInfo().coveragePercent}hasSufficientMeasurements(t=10){return this.getMeasurementCoverage()>=t}recomputeGridDetection(){this.#i()}#x(){const t=this._itemsWrapperElement;if(!(typeof window>"u"||!t))try{this._gridObserver=new ResizeObserver(()=>{this.#i()}),this._gridObserver.observe(t)}catch{this._gridObserver=null}}#H(){const t=this._itemsWrapperElement;if(!(typeof window>"u"||!t))try{this._mutationObserver=new MutationObserver(s=>{for(const n of s)if(n.type==="attributes"&&(n.attributeName==="class"||n.attributeName==="style")){this.#i();break}}),this._mutationObserver.observe(t,{attributes:!0,attributeFilter:["class","style"]})}catch{this._mutationObserver=null}}#i(){const t=this._itemsWrapperElement;if(!t){this._gridDetected=!1,this._gridColumns=1;return}let s=!1,n=1;try{const r=getComputedStyle(t);if(r.display==="grid"){const h=r.gridTemplateColumns,c=/repeat\(\s*(\d+)\s*,/i.exec(h);if(c&&c[1])n=Math.max(1,parseInt(c[1],10)),s=!0;else if(h&&h!=="none"){const o=this.#M(h);Number.isFinite(o)&&o>0&&(n=o,s=!0)}}}catch{}if(!s){const r=t.children;if(r&&r.length>0){const h=r[0].getBoundingClientRect().top;let c=0;for(let o=0;o<r.length;o+=1){const u=r[o].getBoundingClientRect().top;if(Math.abs(u-h)<=1)c+=1;else break}c>0&&(n=c,s=c>1)}}this._gridDetected=s,this._gridColumns=Math.max(1,n),this._internalDebug}#M(t){let s=0,n=0,r=!1;for(let h=0;h<t.length;h+=1){const c=t[h];c==="("?s+=1:c===")"&&(s=Math.max(0,s-1)),s===0&&/\s/.test(c)?r&&(n+=1,r=!1):c!==" "&&(r=!0)}return r&&(n+=1),n}}var be=gt('<span class="text-sm text-secondary"> </span>'),Te=gt('<div class="flex flex-row gap-3 ms-auto"><!></div>'),we=gt('<div class="relative block max-w-full"><div class="relative flex h-full w-fit shrink-0 flex-nowrap items-center gap-1 bg-black px-1.5 py-0.5 text-sm whitespace-nowrap text-white"><p> </p> <span> </span></div> <div class="relative block h-4 w-full rounded-b bg-gradient-to-r from-brand-1 from-10% via-amber-400 to-green-500"><div class="absolute block h-full w-1 shrink-0 -translate-x-1/2 bg-black whitespace-nowrap"></div></div></div>'),xe=gt('<div><div><div class="flex aspect-square w-40 max-w-[10rem] md:h-full md:w-auto md:max-w-fit shrink-0 p-2 bg-white rounded"><!></div> <div class="flex w-full flex-col gap-2"><div class="flex flex-row items-center gap-3"><a class="hover:underline"><h2 class="text-xl font-bold md:text-2xl"> </h2></a></div> <div class="flex flex-col items-start gap-0.5 md:flex-row md:gap-3"><div class="flex flex-col gap-0.5 md:gap-1"><p> </p> <p> </p> <p> </p></div> <div class="flex flex-col gap-0.5 md:gap-1"><p> </p> <p> </p> <p> </p></div></div> <div class="flex items-center gap-2 text-sm text-secondary"><!> <span class="text-sm"> </span></div> <div class="flex flex-col gap-4 lg:flex-row lg:items-center"><div class="flex items-center gap-2"><p class="text-3xl font-bold drop-shadow-lg"> </p> <!> <span class="text-sm text-secondary"> </span></div> <div class="flex flex-row items-center gap-3"><!></div> <!></div></div></div> <!></div>');function Ee(g,t){zt(t,!0);let s=ot(t,"highlight",3,null),n=ot(t,"quantity",3,1);var r=xe(),h=T(r),c=T(h),o=T(c);Jt(o,{get number(){return t.product[D.Number]},get name(){return t.product[D.Name]}}),_(c);var u=A(c,2),d=T(u),l=T(d),b=T(l),w=T(b);_(b),_(l),_(d);var x=A(d,2),H=T(x),I=T(H),R=T(I,!0);_(I);var M=A(I,2),L=T(M);_(M);var P=A(M,2),F=T(P,!0);_(P),_(H);var j=A(H,2),tt=T(j),Y=T(tt,!0);_(tt);var G=A(tt,2),e=T(G,!0);_(G);var ct=A(G,2),Mt=T(ct,!0);_(ct),_(j),_(x);var mt=A(x,2),_t=T(mt);Zt(_t,{name:"map_pin"});var ht=A(_t,2),et=T(ht);_(ht),_(mt);var it=A(mt,2),dt=T(it),J=T(dt),z=T(J);_(J);var st=A(J,2);{var Q=O=>{var k=be(),U=T(k);_(k),xt(()=>V(U,`@ ${t.product[D.Price]??""} € / kpl`)),lt(O,k)};Ht(st,O=>{n()>1&&O(Q)})}var K=A(st,2),yt=T(K);_(K),_(dt);var N=A(dt,2),Ct=T(N);Qt(Ct,{get item(){return t.product}}),_(N);var bt=A(N,2);{var It=O=>{var k=Te(),U=T(k);Nt(U,()=>t.renderExtras),_(k),lt(O,k)};Ht(bt,O=>{t.renderExtras&&O(It)})}_(it),_(u),_(h);var ft=A(h,2);{var Dt=O=>{const k=X(()=>{const[E,nt]=t.kaljakori.getMinAndMaxValues(s());return{_:E,max:nt}}),U=X(()=>Number(t.product[s()])/i(k).max),Z=X(()=>["Matala","Kohtalainen","Korkea"]),rt=X(()=>i(Z)[Number(((i(Z).length-1)*i(U)).toFixed(0))]);var a=we(),m=T(a),p=T(m),v=T(p);_(p);var S=A(p,2),y=T(S);_(S),_(m);var B=A(m,2),q=T(B);_(B),_(a),xt(E=>{Lt(m,`left: ${100*i(U)}%; transform: translateX(-${100*i(U)}%);`),V(v,`${E??""}: ${t.product[s()]??""}
                    ${te[s()]??""}`),V(y,`- ${i(rt)??""}`),Lt(q,`left: ${100*i(U)}%; transform: translateX(${50-100*i(U)}%);`)},[()=>$t(s())]),lt(O,a)};Ht(ft,O=>{s()&&O(Dt)})}_(r),xt((O,k,U,Z,rt,a,m,p,v,S,y)=>{Ut(r,1,O),Ut(h,1,k),Xt(l,"href",`/tuotteet/${t.product[D.Number]}`),V(w,`${t.product[D.Name]??""} (${U??""})`),V(R,Z),V(L,`${rt??""}
                        ${a??""}`),V(F,m),V(Y,p),V(e,v),V(Mt,S),V(et,`${t.product[D.Country]??""}
                    ${(t.product[D.Region]?` - ${t.product[D.Region]}`:null)??""}`),V(z,`${y??""} €`),V(yt,`(${t.product[D.PricePerLiter]??""} €/L)`)},[()=>At(Pt("relative flex flex-col overflow-clip rounded border border-primary bg-primary")),()=>At(Pt("flex flex-col flex-nowrap items-center gap-4 p-4 md:flex-row")),()=>kt(t.product[D.BottleSize],D.BottleSize),()=>ut(t.product[D.Manufacturer],D.Manufacturer),()=>ut(t.product[D.Type],D.Type),()=>t.product[D.Type]==="Oluet"?`- ${kt(t.product[D.BeerType],D.BeerType)}`:null,()=>ut(t.product[D.SubType],D.SubType),()=>ut(t.product[D.AlcoholPercentage],D.AlcoholPercentage),()=>ut(t.product[D.AlcoholGramsPerEuro],D.AlcoholGramsPerEuro),()=>ut(t.product[D.EstimatedPromille],D.EstimatedPromille),()=>(t.product[D.Price]*n()).toFixed(2)]),lt(g,r),Vt()}export{Ee as P,Se as S};
