import{r as Nt,e as jt}from"../chunks/JCeqF_CI.js";import{s as Ct,a as Lt}from"../chunks/hii8YTFM.js";import{ap as zt,aC as Mt,Y as Ft,aD as Ot,aE as Vt,a0 as Rt,u as qt,aF as Gt,aG as Ht,aH as Dt,aI as xt,aJ as Ut,q as Jt,n as E,m as Kt,b as bt,V as Wt,s as st,o as vt,k as L,v as s,w as v,x as n,j as I,ac as lt,y as K,e as P,g as ht,a9 as C,d as wt,f as ot,z as Yt}from"../chunks/DDtI3ySZ.js";import{P as Qt,a as Xt}from"../chunks/DADVxvfE.js";import{p as Zt}from"../chunks/D-OOAyNg.js";import{i as pt,b as $t}from"../chunks/MADWfPdD.js";import{s as ta}from"../chunks/Bxanz9Be.js";import{A as r,I as Z,e as $,t as tt,f as nt,g as at,H as rt,i as aa}from"../chunks/D2H9T7Pv.js";import{f as ra,P as ea,B as oa,A as ia,a as sa}from"../chunks/T_EVkrq1.js";import{S as na,P as la}from"../chunks/BY6nYbWK.js";import{g as ca}from"../chunks/DZtLSn5d.js";const da=()=>performance.now(),A={tick:a=>requestAnimationFrame(a),now:()=>da(),tasks:new Set};function kt(){const a=A.now();A.tasks.forEach(t=>{t.c(a)||(A.tasks.delete(t),t.f())}),A.tasks.size!==0&&A.tick(kt)}function ua(a){let t;return A.tasks.size===0&&A.tick(kt),{promise:new Promise(e=>{A.tasks.add(t={c:a,f:e})}),abort(){A.tasks.delete(t)}}}function et(a,t){xt(()=>{a.dispatchEvent(new CustomEvent(t))})}function fa(a){if(a==="float")return"cssFloat";if(a==="offset")return"cssOffset";if(a.startsWith("--"))return a;const t=a.split("-");return t.length===1?t[0]:t[0]+t.slice(1).map(e=>e[0].toUpperCase()+e.slice(1)).join("")}function _t(a){const t={},e=a.split(";");for(const o of e){const[l,c]=o.split(":");if(!l||c===void 0)break;const d=fa(l.trim());t[d]=c.trim()}return t}const va=a=>a;function mt(a,t,e,o){var l=(a&Ht)!==0,c=(a&Dt)!==0,d=l&&c,w=(a&Gt)!==0,R=d?"both":l?"in":"out",p,_=t.inert,x=t.style.overflow,m,b;function k(){return xt(()=>p??=e()(t,o?.()??{},{direction:R}))}var f={is_global:w,in(){if(t.inert=_,!l){b?.abort(),b?.reset?.();return}c||m?.abort(),et(t,"introstart"),m=ct(t,k(),b,1,()=>{et(t,"introend"),m?.abort(),m=p=void 0,t.style.overflow=x})},out(u){if(!c){u?.(),p=void 0;return}t.inert=!0,et(t,"outrostart"),b=ct(t,k(),m,0,()=>{et(t,"outroend"),u?.()})},stop:()=>{m?.abort(),b?.abort()}},g=zt;if((g.transitions??=[]).push(f),l&&Mt){var y=w;if(!y){for(var i=g.parent;i&&(i.f&Ft)!==0;)for(;(i=i.parent)&&(i.f&Ot)===0;);y=!i||(i.f&Vt)!==0}y&&Rt(()=>{qt(()=>f.in())})}}function ct(a,t,e,o,l){var c=o===1;if(Ut(t)){var d,w=!1;return Jt(()=>{if(!w){var g=t({direction:c?"in":"out"});d=ct(a,g,e,o,l)}}),{abort:()=>{w=!0,d?.abort()},deactivate:()=>d.deactivate(),reset:()=>d.reset(),t:()=>d.t()}}if(e?.deactivate(),!t?.duration)return l(),{abort:E,deactivate:E,reset:E,t:()=>o};const{delay:R=0,css:p,tick:_,easing:x=va}=t;var m=[];if(c&&e===void 0&&(_&&_(0,1),p)){var b=_t(p(0,1));m.push(b,b)}var k=()=>1-o,f=a.animate(m,{duration:R,fill:"forwards"});return f.onfinish=()=>{f.cancel();var g=e?.t()??1-o;e?.abort();var y=o-g,i=t.duration*Math.abs(y),u=[];if(i>0){var T=!1;if(p)for(var S=Math.ceil(i/16.666666666666668),B=0;B<=S;B+=1){var N=g+y*x(B/S),W=_t(p(N,1-N));u.push(W),T||=W.overflow==="hidden"}T&&(a.style.overflow="hidden"),k=()=>{var z=f.currentTime;return g+y*x(z/i)},_&&ua(()=>{if(f.playState!=="running")return!1;var z=k();return _(z,1-z),!0})}f=a.animate(u,{duration:i,fill:"forwards"}),f.onfinish=()=>{k=()=>o,_?.(o,1-o),l()}},{abort:()=>{f&&(f.cancel(),f.effect=null,f.onfinish=E)},deactivate:()=>{l=E},reset:()=>{o===0&&_?.(1,0)},t:()=>k()}}async function pa({parent:a,params:t}){const e=await a(),o=await e.alko,l=t.id?.split("/")[0];return l||Nt(300,"/"),o.kaljakori.findById(l)||jt(404,{message:"Tuotetta ei löytynyt"}),e}const Oa=Object.freeze(Object.defineProperty({__proto__:null,load:pa},Symbol.toStringTag,{value:"Module"})),_a=a=>a;function gt(a,{delay:t=0,duration:e=400,easing:o=_a}={}){const l=+getComputedStyle(a).opacity;return{delay:t,duration:e,easing:o,css:c=>`opacity: ${c*l}`}}var ma=(a,t)=>t(),ga=(a,t)=>{I(t)?.scroll({index:0,smoothScroll:!1})},xa=L("<button><!> <span> </span></button>"),ba=L('<div class="flex w-full flex-col gap-3"><div class="grid w-full grid-cols-1 md:grid-cols-[auto_1fr] gap-6"><div class="flex aspect-square h-56 w-full max-w-full p-6 md:w-fit bg-white rounded"><!></div> <div class="flex w-full flex-col justify-between gap-3"><div class="flex flex-col gap-2"><h2 class="text-lg font-bold md:text-xl">Samankaltaisia tuotteita kuin:</h2> <h1 class="text-2xl font-bold md:text-3xl"><a class="hover:underline"> </a></h1> <span> </span> <p class="w-fit rounded bg-gray-100 dark:bg-zinc-700 dark:text-white px-1"> </p> <div class="flex w-full flex-row gap-2 md:flex-row"><!></div></div> <div class="flex flex-col items-end gap-1"><p class="text-4xl font-bold"> </p> <span class="text-sm text-secondary"> </span></div></div></div> <div class="grid grid-cols-[1fr_auto_1fr] items-center gap-3"><hr class="border-primary"/> <span class="text-sm text-secondary">Vastaavin ensin</span> <hr class="border-primary"/></div></div>'),ha=(a,t)=>t().showModal(),wa=L("<button><span>Lisää listaan</span> <!></button>"),ka=L('<h2 class="text-xl">Valitse lista</h2> <!>',1),ya=L('<div class="absolute top-0 left-0 flex flex-nowrap items-center gap-0.5 rounded-br bg-gray-100 dark:bg-zinc-700 px-1.5 py-0.5 text-sm text-secondary"><!> <span> </span></div> <!>',1),Ta=L('<div><div class="flex w-full items-center justify-between gap-4"><button><!> <span></span></button> <!></div> <div class="flex max-h-full flex-auto flex-col overflow-hidden"><!></div></div>');function Sa(a,t){bt(t,!0);const e=()=>Lt(aa,"$isMobile",o),[o,l]=Ct();let c=vt(null),d=vt(!1),w=ra(t.product,t.kaljakori,new Set([r.Type,r.SubType,r.BeerType,r.Price,r.BottleSize,r.Sugar,r.PackagingType,r.AlcoholGramsPerEuro,r.GrapeVarieties,r.Description]),t.kaljakori.data.length);function R(){window.history.length>1?window.history.back():ca("/")}Wt(()=>{const i=document.getElementById("virtual-list-viewport");i?.addEventListener("scroll",()=>{i.scrollTop>0?st(d,!0):st(d,!1)})});var p=Ta(),_=s(p),x=s(_);x.__click=[ma,R];var m=s(x);Z(m,{name:window.history.length>1?"arrow_back":"home",class:"inline-block"});var b=v(m,2);b.textContent=window.history.length>1?"Takaisin":"Etusivulle",n(x);var k=v(x,2);{var f=i=>{var u=xa();u.__click=[ga,c];var T=s(u);Z(T,{name:"arrow_to_top"});var S=v(T,2),B=s(S,!0);n(S),n(u),K(N=>{at(u,1,N),C(B,e()?"Alkuun":"Hyppää alkuun")},[()=>$(tt(nt.button({size:"md"})))]),mt(1,u,()=>gt,()=>({duration:200})),mt(2,u,()=>gt,()=>({duration:200})),P(i,u)};pt(k,i=>{I(d)&&i(f)})}n(_);var g=v(_,2),y=s(g);{const i=(T,S=E,B=E)=>{var N=wt(),W=ot(N);{var z=M=>{var Y=ba(),Q=s(Y),F=s(Q),q=s(F);ea(q,{get number(){return t.product[r.Number]},get name(){return t.product[r.Name]},transform:"medium",get alt(){return t.product[r.Name]}}),n(F);var G=v(F,2),O=s(G),H=v(s(O),2),D=s(H),dt=s(D,!0);n(D),n(H);var X=v(H,2),U=s(X);n(X);var j=v(X,2),h=s(j,!0);n(j);var V=v(j,2),J=s(V);oa(J,{get item(){return t.product}}),n(V),n(O);var ut=v(O,2),it=s(ut),Tt=s(it);n(it);var ft=v(it,2),St=s(ft);n(ft),n(ut),n(G),n(Q),Yt(2),n(Y),K((Pt,Et,At,Bt,It)=>{ta(D,"href",`/tuotteet/${t.product[r.Number]}`),C(dt,t.product[r.Name]),C(U,`${Pt??""} | ${Et??""} | ${At??""}
                                        ${Bt??""}`),C(h,t.product[r.Availability]),C(Tt,`${It??""} €`),C(St,`(${t.product[r.PricePerLiter]??""} €/L)`)},[()=>rt(t.product[r.Manufacturer],r.Manufacturer),()=>rt(t.product[r.BottleSize],r.BottleSize),()=>rt(t.product[r.AlcoholPercentage],r.AlcoholPercentage),()=>t.product[r.Vintage]!==""?`| ${rt(t.product[r.Vintage],r.Vintage)}`:"",()=>t.product[r.Price].toFixed(2)]),P(M,Y)},yt=M=>{la(M,{get product(){return S()},get kaljakori(){return t.kaljakori},renderExtras:Q=>{var F=ya(),q=ot(F),G=s(q);Z(G,{name:"hashtag"});var O=v(G,2),H=s(O,!0);n(O),n(q);var D=v(q,2);Qt(D,{class:"gap-4 p-4",renderButton:(U,j=E)=>{var h=wa();h.__click=[ha,j];var V=v(s(h),2);Z(V,{name:"plus"}),n(h),K(J=>at(h,1,J),[()=>$(tt(nt.button({type:"positive"}),"ml-auto"))]),P(U,h)},renderContent:(U,j=E)=>{var h=ka(),V=v(ot(h),2);ia(V,{action:J=>{S()&&sa(J,S()[r.Number]),j().close()}}),P(U,h)},$$slots:{renderButton:!0,renderContent:!0}}),K(()=>C(H,`${B()}`)),P(Q,F)},$$slots:{renderExtras:!0}})};pt(W,M=>{B()===0?M(z):M(yt,!1)})}P(T,N)};let u=lt(()=>[null,...w]);$t(na(y,{get items(){return I(u)},itemsClass:"relative flex flex-col gap-3",renderItem:i,$$slots:{renderItem:!0}}),T=>st(c,T,!0),()=>I(c))}n(g),n(p),K((i,u)=>{at(p,1,i),at(x,1,u)},[()=>$(tt("mx-auto flex w-full max-w-[120ch] flex-auto flex-col flex-nowrap p-4 gap-4 md:p-6")),()=>$(tt(nt.button({size:"md"})))]),P(a,p),ht(),l()}Kt(["click"]);var Pa=L('<div class="grid h-full w-full place-content-center"><div class="flex flex-col items-center gap-3"><span class="block h-16 w-16 animate-spin rounded-full border-[0.5rem] border-red-600 border-b-transparent"></span> <p>Ladataan...</p></div></div>');function Va(a,t){bt(t,!0);let e=lt(()=>Zt.params.id?.split("/")[0]);var o=wt(),l=ot(o);Xt(l,()=>t.data.alko,c=>{var d=Pa();P(c,d)},(c,d)=>{const w=lt(()=>I(d).kaljakori.findById(I(e)));Sa(c,{get product(){return I(w)},get kaljakori(){return I(d).kaljakori}})}),P(a,o),ht()}export{Va as component,Oa as universal};
