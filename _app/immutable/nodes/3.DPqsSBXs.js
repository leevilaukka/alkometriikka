import{v as Wa,g as Xa,i as Za,l as Gt,s as te,b as ae,r as ee,u as re,c as oe,A as pa,a as se}from"../chunks/T_EVkrq1.js";import{e as le}from"../chunks/JCeqF_CI.js";import{l as ne,r as la,s as Kt,e as na,a as ia,b as da}from"../chunks/Bxanz9Be.js";import{a as Bt,s as ie}from"../chunks/hii8YTFM.js";import{m as fa,b as ga,o as ot,ab as yt,aa as de,a3 as Qt,j as t,u as ue,ac as D,k as g,f as B,v as e,w as r,x as a,y as k,e as p,g as ba,af as ua,a9 as q,n as At,s as tt,z as Dt,d as Lt,ad as ve,ae as ce}from"../chunks/DDtI3ySZ.js";import{P as _e,a as me}from"../chunks/DADVxvfE.js";import{i as z,b as Ot}from"../chunks/MADWfPdD.js";import{C as pe,d as va,I as L,e as c,t as _,f as b,g as m,p as fe,q as pt,n as ge,o as be,v as he,i as xe,k as ke,j as we,A as R,G as Ht,w as ye,m as ca,l as Ae,x as Le,h as _a}from"../chunks/D2H9T7Pv.js";import{b as ma}from"../chunks/Dp9Vh1qo.js";import{K as Se}from"../chunks/D9o_Nv1L.js";import{S as Ce,P as je}from"../chunks/BY6nYbWK.js";import{F as Fe}from"../chunks/CvfH1Nsb.js";import{g as ha}from"../chunks/DZtLSn5d.js";async function Pe({parent:j,url:o}){const S=await j(),X=o.searchParams.get("list"),O=X&&Wa(X),I=O?JSON.parse(ne.decompressFromEncodedURIComponent(X)):null;return X&&!O&&le(400,{message:"Listan tietoja ei voida lukea. Tarkista linkki."}),{...S,list:I}}const xr=Object.freeze(Object.defineProperty({__proto__:null,load:Pe},Symbol.toStringTag,{value:"Module"}));var qe=()=>window.history.length>1?window.history.back():ha("/"),Ne=(j,o)=>{o()},Te=g('<button><!> <span class="hidden md:block">Tiedot</span></button> <button><!><span class="hidden md:block">Jaa</span></button>',1),ze=g('<input type="text" name="listName" class="w-full border-none bg-transparent p-0 text-2xl leading-none focus:ring-0"/> <!>',1),Ie=g('<h2 class="text-lg leading-none md:text-2xl"> </h2> <button><span>Tallenna lista</span> <!></button>',1),Ve=g('<div class="grid flex-auto place-content-center"><div class="mx-auto prose text-center"><h2>Lista on tyhjä!</h2> <p>Lisää tuotteita listaan tuotevalikosta!</p> <a href="/"><span>Tuotevalikkoon</span> <!></a></div></div>'),Ee=g('<aside class="z-10 flex h-full flex-col overflow-hidden border-primary md:w-84 md:border-e"><!></aside>'),Me=g("<option> </option>"),$e=(j,o,S)=>{tt(o,!t(o)),t(S)?.scroll({index:0,smoothScroll:!1})},Ge=g('<button><span class="hidden whitespace-nowrap md:block"> </span> <!></button>'),Ke=g("<option> </option>"),Be=(j,o)=>{t(o)?.toggleFilterElement()},Oe=g("<button><span>Näytä suodattimet</span> <!></button>"),He=(j,o)=>{t(o)?.scroll({index:0,smoothScroll:!1})},Qe=(j,o,S)=>{o(S(),-1)},De=(j,o,S)=>{o(S(),1)},Re=g('<div><button><!></button> <input type="number"/> <button><!></button></div>'),Je=g("<button><span>Poista listasta</span> <!></button>"),Ue=(j,o)=>o().showModal(),Ye=g("<button><span>Lisää listaan</span> <!></button>"),We=g('<h2 class="text-xl">Valitse lista</h2> <!>',1),Xe=g('<div class="absolute top-0 left-0 flex flex-nowrap items-center gap-0.5 rounded-br bg-gray-100 dark:bg-zinc-700 px-1.5 py-0.5 text-sm text-secondary"><!> <span> </span></div> <!> <!>',1),Ze=(j,o)=>{o()},tr=g('<div class="flex flex-row flex-wrap justify-end gap-4"><button>Sulje</button></div>'),ar=g('<!> <main class="mx-auto flex h-full w-full flex-col gap-3 bg-secondary p-3 md:gap-4 md:p-6"><div class="flex w-full flex-col items-start gap-4"><div><div class="flex flex-col"><label class="text-sm"></label> <div class="flex flex-row flex-nowrap"><select name="sortingColumn" id="sortingColumn"></select> <!></div></div> <div class="flex flex-col"><label class="text-sm"></label> <select name="selectedHighlight" id="selectedHighlight"></select></div></div></div> <div class="flex flex-row flex-nowrap items-center justify-between gap-2"><!> <button><!> <span> </span></button></div> <div class="flex flex-auto flex-col"><!></div></main> <aside class="z-10 flex h-full flex-col overflow-x-hidden overflow-y-auto border-primary xl:border-s"><dialog><h2 class="text-2xl font-bold">Listan tiedot</h2> <div class="flex flex-auto flex-col gap-4"><p> </p> <p> </p> <p> </p> <p> </p> <p> </p> <p> </p> <div><!> <h2> </h2></div></div> <!></dialog></aside>',1),er=g('<div class="flex flex-row items-center justify-between gap-4 border-b border-primary p-3 md:p-4"><button><!> <span class="hidden md:block"></span></button> <!></div> <div><!></div>',1);function rr(j,o){ga(o,!0);const S=()=>Bt(fe,"$isLaptop",I),X=()=>Bt(ke,"$searchQuery",I),O=()=>Bt(xe,"$isMobile",I),[I,ft]=ie();let gt=ot(yt([])),St=de(pe.SearchParamsManager);const dt=Xa(o.list.id),d=dt||o.list,st=D(()=>he(o.dataset,d.items.map(l=>l.id))),w=D(()=>new Se(t(st),pt));let J=ot(null),N=ot(null);function lt(){t(N)&&(t(N).open?t(N).close():S()?t(N).showModal():t(N).show())}Qt(()=>{t(N)?.open&&t(N).close(),!S()&&t(N)?.show()});let ut=ot(null),vt=ot(yt(Za(ue(()=>t(w))))),ct=ot(yt(va)),Z=ot(yt(va)),bt=D(()=>we[t(Z)]||!1),xa=D(()=>{let l={...t(vt)};Object.keys(l).forEach(u=>{Array.isArray(l[u])&&t(w).getFilterType(u)!=="number"&&(l[u]=new Set(l[u]))});let i=t(w).fuzzySearchAndFilter(X(),l);return t(Z)&&(i=i.sort((u,C)=>u[t(Z)]>C[t(Z)]?1:-1)),t(bt)||(i=i.reverse()),i});function ka(){let l=0,i=0,u=0,C=0,y=0;d.items.forEach(h=>{const V=t(w).data.find(U=>U[R.Number]===h.id);V&&(u+=h.q,l+=V[R.Price]*h.q,i+=V[R.AlcoholGrams]*h.q,C+=(V[R.Sugar]||0)*h.q,y+=V[R.BottleSize]*h.q)});const A=l>0?i/l:0,T=i/((pt.weight||(pt.gender===Ht.Female?76:pt.gender===Ht.Male?86:79))*(pt.gender===Ht.Male?.68:.55));return{totalPrice:l.toFixed(2),totalAlcoholGrams:i.toFixed(2),totalAlcoholGramsPerEuro:A.toFixed(2),totalItems:u,totalSugar:C.toFixed(2),totalBAC:T.toFixed(2),totalVolume:y.toFixed(2)}}let at=D(ka);function wa(l){l.trim().length===0?d.name="Nimetön lista":d.name=l.trim()}function Rt(l,i){re(d,l[R.Number],oe(d,l[R.Number])+i)}Qt(()=>{St.setParameter("list",Gt(d))});var ya={toggleDetailsElement:lt},Jt=er(),Ct=B(Jt),_t=e(Ct);_t.__click=[qe];var Ut=e(_t);L(Ut,{name:"arrow_back",class:"inline-block"});var Aa=r(Ut,2);Aa.textContent=window.history.length>1?"Takaisin":"Etusivulle",a(_t);var La=r(_t,2);{var Sa=l=>{var i=ze(),u=B(i);la(u);var C=r(u,2);{var y=A=>{var T=Te(),h=B(T);h.__click=[Ne,lt];var V=e(h);L(V,{name:"sidebar",class:"inline-block "}),Dt(2),a(h);var U=r(h,2);U.__click=async()=>{await ye({title:`Alkometriikka - ${d.name}`,text:`Katso lista: ${d.name}`,url:`${location.origin}/listat?list=${Gt(d)}`})||alert("Linkki kopioitu leikepöydälle!")};var et=e(U);L(et,{name:"share",class:"inline-block "}),Dt(),a(U),k((ht,Ft)=>{m(h,1,ht),m(U,1,Ft)},[()=>c(_(b.button({size:"md"}),"aspect-square md:aspect-auto")),()=>c(_(b.button({type:"positive",size:"md"}),"aspect-square md:aspect-auto"))]),p(A,T)};z(C,A=>{d.items.length>0&&A(y)})}ua("blur",u,()=>wa(d.name)),ma(u,()=>d.name,A=>d.name=A),p(l,i)},Ca=l=>{var i=Ie(),u=B(i),C=e(u,!0);a(u);var y=r(u,2);y.__click=()=>{const T=te(d);ha(`?list=${Gt(T)}`)};var A=r(e(y),2);L(A,{name:"save"}),a(y),k(T=>{q(C,d.name),m(y,1,T)},[()=>c(_(b.button({type:"positive",size:"md"})))]),p(l,i)};z(La,l=>{dt?l(Sa):l(Ca,!1)})}a(Ct);var jt=r(Ct,2),ja=e(jt);{var Fa=l=>{var i=Ve(),u=e(i),C=r(e(u),4),y=r(e(C),2);L(y,{name:"arrow_right_stroke"}),a(C),a(u),a(i),k(A=>m(C,1,A),[()=>c(_(b.button({type:"positive"}),"mx-auto w-full"))]),p(l,i)},Pa=l=>{var i=ar(),u=B(i);{var C=n=>{var s=Ee(),v=e(s);Ot(Fe(v,{get kaljakori(){return t(w)},useURLParams:!1,get filterValues(){return t(vt)},set filterValues(f){tt(vt,f,!0)},get activeFilters(){return t(gt)},set activeFilters(f){tt(gt,f,!0)}}),f=>tt(ut,f,!0),()=>t(ut)),a(s),p(n,s)};z(u,n=>{t(w).data.length>1&&n(C)})}var y=r(u,2),A=e(y),T=e(A),h=e(T),V=e(h);Kt(V,"for","sortingColumn"),V.textContent="Järjestys";var U=r(V,2),et=e(U);na(et,21,()=>ge,ia,(n,s)=>{const v=D(()=>t(w).getFilterValues(t(s)).length>0);var f=Lt(),x=B(f);{var E=M=>{var F=Me(),nt=e(F,!0);a(F);var Y={};k(it=>{q(nt,it),Y!==(Y=t(s))&&(F.value=(F.__value=t(s))??"")},[()=>ca(t(s))]),p(M,F)};z(x,M=>{t(v)&&M(E)})}p(n,f)}),a(et);var ht=r(et,2);{var Ft=n=>{var s=Ge();s.__click=[$e,bt,J];var v=e(s),f=e(v,!0);a(v);var x=r(v,2);{let E=D(()=>t(bt)?"up_arrow_alt":"down_arrow_alt");L(x,{get name(){return t(E)}})}a(s),k((E,M)=>{m(s,1,E),q(f,M)},[()=>c(_(b.button(),"rounded-none rounded-e border-s-0")),()=>Ae(t(bt),t(Z))]),p(n,s)};z(ht,n=>{t(Z)&&n(Ft)})}a(U),a(h);var Yt=r(h,2),Pt=e(Yt);Kt(Pt,"for","selectedHighlight"),Pt.textContent="Korostus";var xt=r(Pt,2);na(xt,21,()=>be,ia,(n,s)=>{const v=D(()=>t(w).getFilterValues(t(s)).length>0);var f=Lt(),x=B(f);{var E=M=>{var F=Ke(),nt=e(F,!0);a(F);var Y={};k(it=>{q(nt,it),Y!==(Y=t(s))&&(F.value=(F.__value=t(s))??"")},[()=>ca(t(s))]),p(M,F)};z(x,M=>{t(v)&&M(E)})}p(n,f)}),a(xt),a(Yt),a(T),a(A);var qt=r(A,2),Wt=e(qt);{var Na=n=>{var s=Oe();s.__click=[Be,ut];var v=r(e(s),2);L(v,{name:"filter"}),a(s),k(f=>m(s,1,f),[()=>c(_(b.button(),"w-full"))]),p(n,s)};z(Wt,n=>{O()&&n(Na)})}var kt=r(Wt,2);kt.__click=[He,J];var Xt=e(kt);L(Xt,{name:"arrow_to_top"});var Zt=r(Xt,2),Ta=e(Zt,!0);a(Zt),a(kt),a(qt);var ta=r(qt,2),za=e(ta);Ot(Ce(za,{get items(){return t(xa)},itemsClass:"flex flex-col gap-3",renderItem:(s,v=At,f=At)=>{const x=D(()=>ae(d,v()[R.Number]));{const E=F=>{var nt=Xe(),Y=B(nt),it=e(Y);L(it,{name:"hashtag"});var oa=r(it,2),Ha=e(oa,!0);a(oa),a(Y);var sa=r(Y,2);{var Qa=H=>{var $=Re(),W=e($);W.__click=[Qe,Rt,v];var rt=e(W);L(rt,{name:"minus"}),a(W);var G=r(W,2);la(G),Kt(G,"min",1),G.__input=K=>{const Q=K.target;Q&&Q.valueAsNumber<=1&&(Q.valueAsNumber=1,t(x).q=1)};var P=r(G,2);P.__click=[De,Rt,v];var mt=e(P);L(mt,{name:"plus"}),a(P),a($),k((K,Q,Ua,Ya)=>{m($,1,K),m(W,1,Q),W.disabled=t(x).q===1,m(G,1,Ua),m(P,1,Ya)},[()=>c(_("flex flex-row")),()=>c(_(b.button(),"rounded-e-none border-e-0",t(x).q===1&&"cursor-not-allowed opacity-50")),()=>c(_(b.input(),"hide-number-input w-[6ch] rounded-none text-center")),()=>c(_(b.button(),"rounded-s-none border-s-0"))]),ua("blur",G,K=>{const Q=K.target;Q&&(!Q.value||Q.valueAsNumber<=1)&&(Q.valueAsNumber=1,t(x).q=1)}),ma(G,()=>t(x).q,K=>t(x).q=K),p(H,$)};z(sa,H=>{t(x)&&H(Qa)})}var Da=r(sa,2);{var Ra=H=>{var $=Je();$.__click=()=>ee(d,v()[R.Number]);var W=r(e($),2);L(W,{name:"trash"}),a($),k(rt=>m($,1,rt),[()=>c(_(b.button({type:"negative"})))]),p(H,$)},Ja=H=>{_e(H,{class:"gap-4 p-4",renderButton:(rt,G=At)=>{var P=Ye();P.__click=[Ue,G];var mt=r(e(P),2);L(mt,{name:"plus"}),a(P),k(K=>m(P,1,K),[()=>c(_(b.button({type:"positive"})))]),p(rt,P)},renderContent:(rt,G=At)=>{var P=We(),mt=r(B(P),2);pa(mt,{action:K=>{se(K,v()[R.Number]),G().close()}}),p(rt,P)},$$slots:{renderButton:!0,renderContent:!0}})};z(Da,H=>{dt?H(Ra):H(Ja,!1)})}k(()=>q(Ha,`${f()+1}`)),p(F,nt)};let M=D(()=>t(x)?.q);je(s,{get product(){return v()},get quantity(){return t(M)},get highlight(){return t(ct)},get kaljakori(){return t(w)},renderExtras:E,$$slots:{renderExtras:!0}})}},$$slots:{renderItem:!0}}),s=>tt(J,s,!0),()=>t(J)),a(ta),a(y);var aa=r(y,2),wt=e(aa),Nt=r(e(wt),2),Tt=e(Nt),Ia=e(Tt);a(Tt);var zt=r(Tt,2),Va=e(zt);a(zt);var It=r(zt,2),Ea=e(It);a(It);var Vt=r(It,2),Ma=e(Vt);a(Vt);var Et=r(Vt,2),$a=e(Et);a(Et);var Mt=r(Et,2),Ga=e(Mt);a(Mt);var $t=r(Mt,2),ea=e($t);L(ea,{name:"shopping_bag"});var ra=r(ea,2),Ka=e(ra);a(ra),a($t),a(Nt);var Ba=r(Nt,2);{var Oa=n=>{var s=tr(),v=e(s);v.__click=[Ze,lt],a(s),k(f=>m(v,1,f),[()=>c(_(b.button({type:"negative"})))]),p(n,s)};z(Ba,n=>{S()&&n(Oa)})}a(wt),Ot(wt,n=>tt(N,n),()=>t(N)),a(aa),k((n,s,v,f,x,E)=>{m(T,1,n),m(et,1,s),m(xt,1,v),m(kt,1,f),q(Ta,O()?"Alkuun":"Hyppää alkuun"),m(wt,1,x),q(Ia,`Tuotteita listassa: ${t(at).totalItems??""}`),q(Va,`Kokonaismäärä: ${t(at).totalVolume??""} L`),q(Ea,`Yhteensä alkoholia: ${t(at).totalAlcoholGrams??""} g`),q(Ma,`Yhteensä sokeria: ${t(at).totalSugar??""} g`),q($a,`Alkoholia per euro: ${t(at).totalAlcoholGramsPerEuro??""} g/€`),q(Ga,`Arvioitu promillemäärä: ${t(at).totalBAC??""} ‰`),m($t,1,E),q(Ka,`Yhteensä: ${t(at).totalPrice??""} €`)},[()=>c(_("grid w-full grid-cols-2 items-end gap-2 md:w-fit")),()=>c(_(b.input(),"w-full rounded-none rounded-s pe-8")),()=>c(_(b.input(),"w-full pe-8")),()=>c(_(b.button(),"ml-auto")),()=>c(_("fixed m-auto hidden h-full w-full flex-col gap-4 rounded-lg bg-primary border border-primary p-4 backdrop:backdrop-blur-sm open:flex xl:relative xl:w-84 xl:rounded-none xl:border-0 transition-transform open:starting:scale-0 md:open:starting:scale-100 open:scale-100")),()=>c(_(b.button({size:"lg"}),"w-full mt-auto hover:cursor-default"))]),da(et,()=>t(Z),n=>tt(Z,n)),da(xt,()=>t(ct),n=>tt(ct,n)),p(l,i)};z(ja,l=>{t(w).data.length===0?l(Fa):l(Pa,!1)})}a(jt),k((l,i)=>{m(_t,1,l),m(jt,1,i)},[()=>c(_(b.button({size:"md"}),"aspect-square md:aspect-auto")),()=>c(_("relative grid h-full max-h-full grid-cols-[1fr_auto] overflow-hidden",t(w).data.length>1&&"grid-cols-[auto_1fr_auto]"))]),p(j,Jt);var qa=ba(ya);return ft(),qa}fa(["click","input"]);var or=()=>window.history.back(),sr=g('<div><div class="flex w-full items-center gap-4"><button><!> <span>Takaisin</span></button></div> <div class="flex flex-auto flex-col items-center gap-4"><!></div></div>'),lr=g('<div class="grid h-full w-full place-content-center"><div class="flex flex-col items-center gap-3"><span class="block h-16 w-16 animate-spin rounded-full border-[0.5rem] border-red-600 border-b-transparent"></span> <p>Ladataan...</p></div></div>');function kr(j,o){ga(o,!0),Qt(()=>{Le({description:o.data.list?`Katso lista "${o.data.list.name}" Alkometriikassa.`:"Selaa ja hallinnoi Alkon tuotteita sisältäviä listoja.",og:{title:o.data.list?`Lista - ${o.data.list.name}`:"Listat",url:window.location.href,description:o.data.list?`Katso lista "${o.data.list.name}" Alkometriikassa.`:"Selaa ja hallinnoi Alkon tuotteita sisältäviä listoja."}})});var S=Lt();ve(O=>{k(I=>ce.title=I,[()=>o.data.list?_a(`Lista - ${o.data.list.name}`):_a("Listat")])});var X=B(S);me(X,()=>o.data.alko,O=>{var I=lr();p(O,I)},(O,I)=>{var ft=Lt(),gt=B(ft);{var St=d=>{rr(d,{get dataset(){return t(I).dataset.table},get list(){return o.data.list}})},dt=d=>{var st=sr(),w=e(st),J=e(w);J.__click=[or];var N=e(J);L(N,{name:"arrow_back",class:"inline-block"}),Dt(2),a(J),a(w);var lt=r(w,2),ut=e(lt);pa(ut,{useSearch:!0,show:{delete:!0,share:!0}}),a(lt),a(st),k((vt,ct)=>{m(st,1,vt),m(J,1,ct)},[()=>c(_("mx-auto flex w-[min(80ch,_100%)] flex-col gap-4 p-4")),()=>c(_(b.button({size:"md"})))]),p(d,st)};z(gt,d=>{o.data.list?d(St):d(dt,!1)})}p(O,ft)}),p(j,S),ba()}fa(["click"]);export{kr as component,xr as universal};
